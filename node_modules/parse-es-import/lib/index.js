"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const acorn_1 = require("acorn");
const acorn_jsx_1 = __importDefault(require("acorn-jsx"));
const JSXParser = acorn_1.Parser.extend(acorn_jsx_1.default());
function parse(content, options = {
    ecmaVersion: 2021,
    sourceType: 'module',
}) {
    const result = [];
    const { body } = JSXParser.parse(content, options);
    if (Array.isArray(body)) {
        body.forEach(({ type, specifiers, source }) => {
            if (type === 'ImportDeclaration') {
                const item = {
                    moduleName: source.value,
                    starImport: '',
                    defaultImport: '',
                    namedImports: [],
                    sideEffectOnly: false,
                };
                if (Array.isArray(specifiers) && specifiers.length) {
                    specifiers.forEach(({ type, local, imported }) => {
                        switch (type) {
                            case 'ImportNamespaceSpecifier':
                                item.starImport = local && local.name;
                                break;
                            case 'ImportDefaultSpecifier':
                                item.defaultImport = local && local.name;
                                break;
                            case 'ImportSpecifier':
                                item.namedImports.push({
                                    name: imported && imported.name,
                                    alias: local && local.name,
                                });
                                break;
                        }
                    });
                }
                else {
                    item.sideEffectOnly = true;
                }
                result.push(item);
            }
        });
    }
    return result;
}
exports.default = parse;
